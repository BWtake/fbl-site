---
title: 「スマートコントラクトに証明可能な安全性を──カルダノに訪れた自動検証革命」
date: 2025-07-18
categories:
  - Cardano
  - Smart Contracts
  - Formal Verification
tags:
  - Cardano
  - Plutus
  - Lean4
  - Z3
  - SMT
  - 自動検証
  - セキュリティ
  - 技術
draft: false
epoch: 570
---

## 🔔 発表概要

2025年7月17日、Input Output Global（IOG）は、Cardanoスマートコントラクトのセキュリティ強化のため、**形式的検証を完全自動化する新ツールの開発**を公式発表した。

このツールは、Lean4（証明言語）とZ3などのSMTソルバーを組み合わせ、開発者が証明コードを記述しなくてもスマートコントラクトの安全性を**数学的に証明**可能にするものである。

---

## 🔍 技術的要点

| 項目 | 内容 |
|------|------|
| 発表日 | 2025年7月17日 |
| 提供元 | Input Output Global（IOG） |
| 対象 | Plutus/Aiken/Plinth などの高水準言語 |
| 中核技術 | Lean4 + SMTソルバー（Z3/CVC5） |
| 機能 | コントラクトの完全自動検証・反例提示・CI/CD統合 |
| 目的 | 「証明可能な安全性（provable security）」をスマートコントラクト開発に標準化する |

---

## ✅ なぜ形式的検証か？

- テストやシナリオ試験では、全ての分岐や悪用パターンを網羅できない
- フォーマルベリフィケーションにより、**どの入力でも安全が保証されることを数学的に証明**
- 自動化により、非専門家でも利用可能に

---

## 🛠 ゲームチェンジャーとなる特徴

1. ✅ **完全自動化**：Lean4ベースで人手による証明不要
2. ✅ **反例の提示**：バグがあれば具体的な反例を返す
3. ✅ **CI/CD統合**：開発フローに組み込み可能
4. ✅ **互換性維持**：開発者が使い慣れたPlutus/Aikenを制限せず活用可能

---

## 🧪 ベスティングコントラクト検証例

### 実装想定：
- 「ロック時間が経過し、受益者が署名」→ 資金が引き出せる

### SMTによる検証結果：
- validity_rangeの上限を不自然に大きく設定 → **本来許可されない時点で資金が引き出されるバグを検出！**

### 結論：
- 通常テストでは発見困難な**境界バグ**を自動検出する強力なツール

---

## 📈 5段階シナリオ分析

| シナリオ | 内容 | 実現確率（予測） |
|----------|------|------------------|
| S5 | Cardano標準に。全dApp・Gov提案が自動検証を経る | 80% |
| S4 | 大手DeFi系dAppで導入。セキュリティ水準が向上 | 65% |
| S3 | 限定的に導入。開発者が学習しながら採用 | 45% |
| S2 | ツールの複雑性により一部で停滞 | 25% |
| S1 | 利用されず、従来型テストに依存 | 10% |

---

## 🌐 他チェーンとの比較

| チェーン | 検証方式 | 強み | 備考 |
|----------|----------|------|------|
| Cardano | Lean4 + SMTソルバー | 意図の安全性保証、自動反例生成 | 開発者に優しい検証環境を構築中 |
| Mina | zk-SNARK | ブロック圧縮・検証軽量化 | 計算はオフチェーン、データ保持型 |
| Polygon zkEVM | zk-SNARK（実行証明） | 高速 + Ethereum互換性 | 実行トレース検証に強みあり |

---

## 🧩 今後の展望

- ✅ UPLC/Plutus Core対応（より下層の自動検証へ）
- ✅ 最適化コードへのフォーマル証明拡張
- ✅ Universal Annotation Languageによる再利用性強化
- ✅ dApp/DeFi分野における標準化の可能性

---

## 📚 出典・参考資料

- IOG公式ブログ  
  「[A new era of smart contract verification on Cardano](https://iohk.io/en/blog/posts/2025/07/17/a-new-era-of-smart-contract-verification-on-cardano/)」  
  発表日：2025年7月17日  
  著者：Romain Soulat

- Lean4：<https://leanprover.github.io>  
- Z3 SMTソルバー：<https://github.com/Z3Prover/z3>  
- Satisfiability Modulo Theories 解説論文：Barrett et al., 2011


---

## 🔍 概要｜Automatic Formal Verification

| 項目 | 内容 |
|------|------|
| **目的** | DAppのスマートコントラクトに対する**完全自動の形式的検証**ツールの開発 |
| **主な特徴** | セキュリティ脆弱性やデッドロックの**自動検出・証明**。要求条件のアノテーションのみで利用可能 |
| **対象** | 2025年にリリース予定の**Plinth**向けに設計。ただし**翻訳モジュール追加で他言語にも対応可能** |
| **現状の課題** | Plutus含むCardano DAppにおける既存の形式検証手法は、手動・高難易度・限定的 |

---

## 🧠 技術的ポイントの解説

| 項目 | 解説 |
|------|------|
| **形式的検証とは？** | 数理論理に基づき、プログラムが仕様通りに正しく動作することを**すべての入力・状態に対して証明**する手法。 |
| **このツールの特徴** | ユーザーはスマートコントラクトに「アノテーション（期待する動作や禁止条件）」を追加するだけで、<br>ツールが自動的に「数理的な証明」または「要件違反のシナリオ」を返す。 |
| **想定エンジン** | Lean4 や Z3 などの SMTソルバー連携型自動証明ツール（詳細は未記載だが、他のIOGプロジェクトと親和性がある） |
| **Plinthとは？** | IOGが開発中の新しい**Plutusアプリケーションインフラ**。形式的検証との高い親和性を持つことが示唆されている。 |

---

## 🎯 問題設定と課題意識

| 項目 | 内容 |
|------|------|
| **現状の問題** | スマートコントラクトのテストでは全実行パターンを網羅できず、未知のバグ・脆弱性が残存しやすい |
| **既存の検証ツール** | 手動操作のものが多く、専門知識を必要とする（例：Coq、Isabelle） |
| **結果として** | Cardano DAppの開発者は、**高信頼性の保証が難しい**状況にある |

---

## ✅ 提案されているソリューションの利点

| 利点 | 内容 |
|------|------|
| ✅ **完全自動化** | 証明プロセスの自動化により、専門知識なしでも利用可能 |
| ✅ **包括的な検証** | 全ての可能なブロックチェーンイベントに対して検証を行う |
| ✅ **セキュリティの向上** | 脆弱性の見逃しが大幅に減少し、経済的損失リスクも軽減 |
| ✅ **他言語対応** | 翻訳モジュール追加で、Plutus以外のスマートコントラクト言語も対応可能 |

---

## 📈 想定されるインパクト（5段階シナリオ分析）

| シナリオ | 概要 | 発生確率（CGTA予測） | インパクト |
|----------|------|----------------------|------------|
| S5｜業界標準に | Plutusだけでなく、他L1にも移植され、DeFiセキュリティ標準に | 15% | 非常に大きい |
| S4｜Cardanoに定着 | Cardano DApp開発の標準プロセスになる | 35% | 大きい |
| S3｜一部活用に留まる | 高度なユーザー・DAOのみが利用 | 30% | 中程度 |
| S2｜限定的採用 | 特定用途（例：国債、RWAなど）での検証に限定 | 15% | 小 |
| S1｜失敗または放棄 | 証明速度・UX・統合コストの課題で使われない | 5% | 無し〜小 |

---

## 💬 BWtakeへの提言

このプロジェクトは、以下の点で**Catalyst資金・Cardanoガバナンス予算の重点投資候補**として推奨されます：

- **安全性の証明が義務化される未来**を見据えた布石
- **Lean4/Z3ベースのフォーマル技術の民主化**の促進
- **Plinth構想との連携強化による2025年以降のDApp信頼性向上**

---

## 📎 参考リンク・出典

- Intersect Technical Committee：[Potential Roadmap Projects](https://committees.docs.intersectmbo.org/intersect-technical-steering-committee/technical-roadmap/potential-roadmap-projects)
- IOGブログ（Lean4・Z3関連）: [https://iohk.io/en/blog](https://iohk.io/en/blog)

---

## ✅ 比較表｜Intersect提案 vs IOG発表（2025/07/17）

| 比較項目 | Intersect版（潜在的ロードマップ提案） | IOG発表版（2025年7月17日公式） |
|----------|------------------------------------|-------------------------------|
| **開発主体** | Intersect TSC発の技術提案（将来的採択候補） | Input Output Global（IOG）が開発進行中 |
| **リリース対象** | Plinth向け（他言語対応も可能） | Plutus / Aiken / Plinth 全対応を明言 |
| **技術基盤** | 明示なし（推測ではZ3等） | Lean4 + SMTソルバー（Z3/CVC5）を明記 |
| **操作性** | アノテーションベースで非専門家も利用可 | CI/CD統合・反例提示・完全自動化を強調 |
| **問題設定** | 手動検証の難しさとテストの限界を指摘 | 悪用パターン未検出のリスクと自動検証の必要性を強調 |
| **利点** | 自動要件生成と全シナリオ対応 | 境界バグ検出・意図安全性・省リソース化 |
| **対応言語** | Plutusベースだが翻訳モジュール追加で他言語も可 | 初期からAikenやPlinthにも対応予定 |
| **セキュリティ価値** | セキュリティ品質保証（高水準） | provable security を開発標準にする構想 |
| **想定利用者** | 開発者（ビジネス要件付きで入力） | 全開発者 + CIパイプライン組込を視野 |
| **デモ例** | 無し | ベスティング契約での不正引き出し検出を提示 |
| **シナリオ評価（CGTA予測）** | 標準化S5＝15%・限定導入S3＝30% | 標準化S5＝80%・広範導入S4＝65%（実現近い） |
| **位置づけ** | 今後の選択肢（検討段階） | 実行中の戦略プロジェクト |

---

## 🧭 総合評価（CGTA所見）

| 評点 | 内容 |
|------|------|
| ✅ | IOG発表はIntersect提案の具体化・技術深化版と評価できる |
| ✅ | Intersect版は「コンセプト提案」、IOG版は「製品設計に踏み込んだ実装計画」 |
| ✅ | 特にLean4＋Z3の明記・反例提示・CI/CD統合などはIOG発表が上回る |
| ✅ | Intersectはガバナンス投資提案として重要であり、IOG版はそれを受けて開発が進行中と考えられる |

---

## 💬 提言

1. **政策誘導的に**  
   フォーマル検証の**標準化プロセス化**をCatalyst投票やConstitution Rule Designに組み込む提案の布石にすべき

2. **観測視点として**  
   「Plinth + Lean4 + CI/CD」の組み合わせは、**開発者の開放性（Open Dev）と安全性の両立**というCardanoの中核思想の体現例であると考察可能

---

*作成日時：2025-07-18*
